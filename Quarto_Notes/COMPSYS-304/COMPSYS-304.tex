% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode,pdfpagelabels}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  14pt,
  a4paper,
  DIV=11,
  numbers=noendperiod,
  headinclude=true,
  footinclude=true]{scrreprt}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage[]{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[top=2.5cm,bottom=2.5cm,left=1.5cm,right=1.5cm,marginparsep=2cm]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother
\pagestyle{plain}


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{graphicx}
\usepackage[many]{tcolorbox}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage[table,xcdraw]{xcolor}
\usepackage{float}
\usepackage{fancyhdr}
% \usepackage{fontspec}
\sisetup{per-mode = symbol} % Set SI unit fractions to use a solidus
\definecolor{boxheadcol}{HTML}{D6D6F0} % #D6D6F0
\definecolor{boxbodycol}{HTML}{EBEBF7} % #EBEBF7
\definecolor{boxtitlecol}{HTML}{4A45B4} % #4A45B4
\definecolor{boxheadcol2}{HTML}{BCD5C6} % #BCD5C6
\definecolor{boxbodycol2}{HTML}{D3E0DF} % #D3E0DF
\definecolor{boxtitlecol2}{HTML}{0A801D} % #0A801D
\definecolor{tablecol1}{HTML}{FFFF66} % #FFFF66
\definecolor{tablecol2}{HTML}{CCCCFF} % #CCCCFF
\definecolor{tablecol3}{HTML}{CCFFFF} % #CCFFFF


\setkomafont{disposition}{\normalcolor\bfseries}
\setkomafont{section}{\normalfont\Large\bfseries}
\setkomafont{chapter}{\normalfont\LARGE\bfseries}
\tcbset{title filled}
\RedeclareSectionCommand[
  beforeskip=10pt, % Space before the chapter
  afterskip=10pt   % Space after the chapter
]{chapter}

% Adjust part spacing
\RedeclareSectionCommand[
  beforeskip=10pt,
  afterskip=10pt
]{part}

% Adjust section spacing
\RedeclareSectionCommand[
  beforeskip=10pt,
  afterskip=10pt
]{section}

\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyhead[L]{\textbf{Nicholas Russell}}%
  \fancyhead[C]{COMPSYS 304 Notes}%
  \fancyhead[R]{September 3rd, 2024}%
  \fancyfoot[R]{\thepage}%
  \renewcommand{\headrulewidth}{0.4pt}%
  \renewcommand{\footrulewidth}{0pt}%
}
\pagestyle{plain}
\setlength{\headheight}{16.5pt}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={COMPSYS 304: Computer Architecture},
  pdfauthor={Nicholas Russell},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{COMPSYS 304: Computer Architecture}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{Lecture Notes}
\author{Nicholas Russell}
\date{Tuesday, September 3, 2024}

\begin{document}
\maketitle

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}

\bookmarksetup{startatroot}

\chapter*{Introduction}\label{introduction}
\addcontentsline{toc}{chapter}{Introduction}

\markboth{Introduction}{Introduction}

These notes are compiled from the lectures of COMPSYS 304. They are
intended as a personal reference to help with assignments, exam
preparation, and understanding key concepts in Computer Architecture.

The notes are organised by lecture and cover a wide range of topics from
basic computer architecture principles to more advanced subjects like
MIPS implementation and performance analysis. Feel free to add personal
insights, additional readings, or questions as you review this material.

\section*{Organisation of the Notes}\label{organisation-of-the-notes}
\addcontentsline{toc}{section}{Organisation of the Notes}

\markright{Organisation of the Notes}

The notes are divided by lecture content, with each section
corresponding to a specific set of topics. Here's how they're organized:

\begin{itemize}
\item
  \textbf{Lecture 1-3: Basics of Computer Architecture}\\
  Key topics include Instruction Set Architecture (ISA), memory
  hierarchy, and basic CPU organisation.
\item
  \textbf{Lecture 4-6: MIPS Architecture}\\
  Covers the MIPS instruction set, control flow, and subroutine
  handling.
\item
  \textbf{Lecture 7-9: CPU Implementation}\\
  Focuses on different methods for implementing CPUs and the trade-offs
  involved.
\item
  \textbf{Lecture 10-12: Digital Circuits and Datapath Design}\\
  Reviews fundamental digital circuit concepts and discusses the design
  of a MIPS datapath.
\item
  \textbf{Lecture 13-15: Performance Analysis}\\
  Provides an in-depth look at how different design choices impact CPU
  performance.
\end{itemize}

\section*{How I Use These Notes}\label{how-i-use-these-notes}
\addcontentsline{toc}{section}{How I Use These Notes}

\markright{How I Use These Notes}

These notes are a living document, and I intend to update them as I gain
a deeper understanding of the material. Here's how I use them:

\begin{itemize}
\tightlist
\item
  \textbf{Quick Reference}: For quick lookups, the Table of Contents
  will help me jump directly to the relevant section.
\item
  \textbf{In-Depth Study}: For exam preparation, I'll revisit each
  section, ensuring I understand each concept before moving on.
\item
  \textbf{Personal Insights}: I'll be adding my own thoughts, additional
  notes from readings, and potential questions for further study.
\end{itemize}

I might also include exercises or practical examples that help solidify
my understanding of the more complex topics.

\part{Lectures 1 - 3}

\chapter{Introduction \& Course
Overview}\label{introduction-course-overview}

This chapter provides an introduction to the course, some background,
and an overview of the course itself.

\section{Background}\label{background}

In the last six decades, computer technology has made incredible
progress due to innovations in both \textbf{semiconductor technology}
and computer \textbf{architecture}.

\subsection{\texorpdfstring{What do we mean from
\emph{Performance}?}{What do we mean from Performance?}}\label{what-do-we-mean-from-performance}

The relative performance can be measured by standard benchmarks, which
depend on the specific target applications.

\textbf{\emph{Performance depends on clock frequency and other factors,
as discussed more in later chapters.}}

\subsection{Intel X86 Processor from 1978 to
2018:}\label{intel-x86-processor-from-1978-to-2018}

\begin{itemize}
\item
  \textbf{Intel 8086} - (1978): 1 core, 1 W, 5 - 10 MHz
\item
  \textbf{Core i7-8086K} - (2018): 6 cores, 95 W, 4 GHz
\end{itemize}

\section{Course Details}\label{course-details}

\subsection{Learning outcomes}\label{learning-outcomes}

The main learning outcomes of this course are:

\begin{itemize}
\item
  \textbf{To understand the basics of modern computer architectures and
  quantitative principles of computer design in order to develop a
  conceptual understanding of issues involved in designing a high
  performance computer system.}
\item
  \textbf{To use and apply this knowledge to design computer systems or
  select computers for specific tasks. This course will give you an
  understanding of the effects of design decisions on system performance
  and makes you a well-informed consumer in addition to a processor
  designer.}
\end{itemize}

Recommended Textbook:

\begin{itemize}
\item
  David A. Patterson and John L. Hennessey, Computer Organization and
  Design: The Hardware/Software Interface, Fifth edition, 2013 by
  Elsevier/Morgan Kaufmann Publishers (or 3rd or 4th editions).
\item
  Lecture notes provided on canvas (these will be summarised in these
  notes).
\end{itemize}

\subsection{Course Overview (learning
outcomes)}\label{course-overview-learning-outcomes}

\textbf{Part 1:} \emph{In this part you will learn to:}

\begin{itemize}
\item
  Design and evaluate the instruction set architectures (both RISC and
  CISC) and how it can be related to the hardware/software interface in
  a computer system with a quick review of assembly programming.
\item
  Understand different processor implementation methods including the
  basic single-cycle implementation and how it can be extended to a
  multi-cycle, pipelined and superscalar implementations.
\item
  Understand performance evaluation techniques and their relation to the
  target applications and the processor workload.
\end{itemize}

\textbf{Part 2:} \emph{In this part you will learn to:}

\begin{itemize}
\item
  Understand the memory hierarchy in a modern computer system and its
  impact on the performance of the system. This includes physical and
  virtual memory systems and basics of cache memories.
\item
  Understand some basic principles of parallel computing using special
  topics in this course (more advanced materials covered in some
  elective courses).
\end{itemize}

\subsection{Assessment}\label{assessment}

Three assignments and one test in addition to the final exam. The first
assignment is mainly on the instruction set architecture design,
hardware/software interfacing and review of assembly programming. The
second assignment is related to processor implementation and performance
issues. The third assignment is related to memory hierarchy system and
multiprocessing.

\textbf{The test only covers the first part of the course. The final
exam covers the whole course.}

\begin{itemize}
\item
  \textbf{Assignment 1: 8\% due Fri. 9 August.}
\item
  \textbf{Assignment 2: 7\% due Fri. 23 August.}
\item
  \textbf{Assignment 3: 15\% due Fri. 4 October.}
\item
  \textbf{Test: 20\% (in week 7, Wednesday 11 September)}
\item
  \textbf{Final exam: 50\%}
\end{itemize}

\chapter{Basics of Computer
Architecture}\label{basics-of-computer-architecture}

This chapter begins the journey into the content of this course.

\section{What is Computer
Architecture?}\label{what-is-computer-architecture}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}

\begin{itemize}
\item
  \textbf{ISA:} The programmer-visible instructions --- ISA serves as
  the boundary between the hardware and software.
\item
  \textbf{Organization:} high-level aspects of computer design (e.g.~the
  internal design of the CPU, the memory system, the interconnection
  structure, \ldots)
\item
  \textbf{Hardware:} detailed logic design, circuit-level design,
  packaging technology, etc.
\end{itemize}

\section{Review: Memory Organization}\label{review-memory-organization}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}

\begin{itemize}
\item
  Memory is viewed as a large, one-dimensional array, which has an
  address range.
\item
  A memory address is an index into the array
\item
  The index usually points to a byte of memory.
\item
  To access a larger word (e.g., a 32-bit word or 4 bytes), four
  consecutive memory locations are accessed.
\end{itemize}

\emph{Memory access time} is the amount of time required to read
(usually one byte) or write data (usually one byte) from/to memory.

\section{An Overview of Memory Speed vs.~CPU
Speed}\label{an-overview-of-memory-speed-vs.-cpu-speed}

The rate of memory speed increase has been less than processors speed
increase

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}

Fast memory is more expensive per bit than slow memory, so a
\textbf{memory hierarchy} is often used to give a performance close to
the fastest memory with a lower average cost per bit.

\section{Processor and Memory
Hierarchy}\label{processor-and-memory-hierarchy}

\begin{figure}[H]

\begin{minipage}{0.40\linewidth}
\includegraphics{lecture1-3/images/processorhierarchy.png}\end{minipage}%
%
\begin{minipage}{0.60\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, colbacktitle=boxheadcol, title=\textcolor{red}{\emph{Processor Registers: }}\textcolor{blue}{The smallest and fastest memory for CPU.}]
Typically, 32 to 64 registers, each of them may be 32 or 64 bits with
typical access time of \textcolor{blue}{\emph{nanoseconds or less}}

\end{tcolorbox}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, colbacktitle=boxheadcol, title=\textcolor{red}{\emph{Cache Memory: }}\textcolor{blue}{Slower than registers.}]
Typically 8 to 256 Kbytes with an access time about a
\textcolor{blue}{\emph{few nanoseconds or less}}

\end{tcolorbox}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, colbacktitle=boxheadcol, title=\textcolor{red}{\emph{Main Memory: }}\textcolor{blue}{Slower than cache memory.}]
Hundreds of Mega bytes with an access time about
\textcolor{blue}{\emph{tens of nanoseconds}}

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\section{Example of Intel Processors}\label{example-of-intel-processors}

\begin{figure}[H]

\begin{minipage}{0.50\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, colbacktitle=boxheadcol, title=\textcolor{red}{\emph{Pentium Processor Architecture (simplified) }}]
An example of architectural innovations made by processor designers (to
improve computer systems performance) \textcolor{red}{(Source: Intel)}

\end{tcolorbox}

\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=8cm,height=\textheight]{lecture1-3/images/22pentium.png}\end{minipage}%
\newline
\begin{minipage}{0.50\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, colbacktitle=boxheadcol, title=\textcolor{red}{\emph{Intel Core i7}}]
The Core i7 die and major components. (more than 700 million transistors
in a die with area \qty{263}{\mm\squared} in \qty{45}{\nm} technology).
\textcolor{red}{(Source: Intel)}

\end{tcolorbox}

\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=8cm,height=\textheight]{lecture1-3/images/corei7diagram.png}\end{minipage}%

\end{figure}%

\chapter{\texorpdfstring{\textcolor{red}{Instruction Set Architecture
(ISA)}}{Instruction Set Architecture (ISA)}}\label{instruction-set-architecture-isa}

An ISA is the \textbf{interface between hardware and low-level software}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, title=Some modern instruction set architectures:, coltitle=boxtitlecol, colbacktitle=boxheadcol]
\textcolor{red}{\textbf{80x86}}, Itanium, PowerPC,
\textcolor{red}{\textbf{MIPS}}, SPARC, HP,
\textcolor{red}{\textbf{ARM}},
\textcolor{red}{\textbf{\underline{RISC-V}}}

\end{tcolorbox}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, title=Issues with a fixed ISA:, coltitle=boxtitlecol, colbacktitle=boxheadcol]

\begin{itemize}
\tightlist
\item
  \textcolor{red}{\textbf{advantage:}} different implementations of the
  same architecture
\end{itemize}

\begin{tcolorbox}[oversize, left=11pt, right=11pt, colback=boxbodycol2, colframe=boxheadcol2, title=Example, coltitle=boxtitlecol2, colbacktitle=boxheadcol2]

\begin{itemize}
\tightlist
\item
  AMD and Intel chips use the same ISA, while their implementations are
  different.
\item
  Pentium II and Celeron have different memory systems and different
  clock rates.
\item
  Core i7, Core i5, Core i3, and Atom are different implementations of
  the same ISA (ignoring some ISA extensions).
\end{itemize}

\end{tcolorbox}

\begin{itemize}
\tightlist
\item
  \textcolor{red}{\textbf{disadvantage:}} sometimes prevents using new
  innovations.
\end{itemize}

\end{tcolorbox}

\textcolor{red}{\textbf{\underline{ISA design:}}}
\textcolor{blue}{\textbf{What is needed to be included in each \textit{\underline{machine instruction?}}}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  What operation is to be performed by the CPU.
\end{enumerate}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
arithmetic/logic operations, data transfer, control transfer, etc.

\end{tcolorbox}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  How data for the operation can be provided.
\end{enumerate}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
through memory, through CPU registers, encoded in the instruction word

\end{tcolorbox}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  How the result is to be stored.
\end{enumerate}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
in memory or register

\end{tcolorbox}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, title=\textcolor{red}{\textbf{Therefore, the ISA must define:}}, coltitle=boxtitlecol, colbacktitle=boxheadcol]

\begin{itemize}
\tightlist
\item
  The operation to be performed (\textbf{\emph{opcode}})
\item
  Data type and size of operands
\item
  Location of operands and results
\item
  Instruction format or Encoding
\end{itemize}

\end{tcolorbox}

\newpage{}

\section{Classifying Instruction Set
Architectures}\label{classifying-instruction-set-architectures}

Each instruction has (an) \textcolor{red}{\textbf{opcode}} which defines
the type of operation and may have zero to three
\textcolor{red}{\textbf{operands}} for input data and the result
destination.

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]

The type storage used for operands is the most basic differentiation
among different types of Instruction Set Architectures (ISA).

\begin{itemize}
\tightlist
\item
  operands from/to memory
\item
  operands from/to registers
\item
  operands from memory/to register or vice versa
\end{itemize}

\end{tcolorbox}

\subsection{\texorpdfstring{\textcolor{red}{\underline{Stack-based Architecture}}}{}}\label{section}

\begin{figure}[H]

\begin{minipage}{0.40\linewidth}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.60\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
The pointer to the \textbf{\emph{top of the stack}} will be adjusted
properly after completing the ALU (\textbf{A}rithmetic / \textbf{L}ogic
\textbf{U}nit) operation to point to the result.

\end{tcolorbox}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textbf{\underline{Instruction:}}\\
\textcolor{red}{\textbf{ADD}}\\
\textcolor{blue}{\textbf{ADD}} has three implicit operands, which are
from/to the \textbf{stack}.

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
Two special instructions \textcolor{red}{\textbf{PUSH}} and
\textcolor{red}{\textbf{POP}} are used to write into the top of the
stack or read from the top of the stack respectively. The
\textbf{\emph{stack pointer}} will be adjusted properly after completing
these operations.

\end{tcolorbox}

\subsection{\texorpdfstring{\textcolor{red}{\underline{Accumulator-based Architecture}}}{}}\label{section-1}

\begin{figure}[H]

\begin{minipage}{0.40\linewidth}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.60\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textbf{\underline{Instruction:}}\\
\textcolor{red}{\textbf{ADD}} \textbf{\emph{mem\_address}}\\
\textcolor{blue}{\textbf{ADD}} has two implicit operands (Accumulator
register) and one explicit operand (memory).

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
Two special instructions \textcolor{red}{\textbf{LOAD}} and
\textcolor{red}{\textbf{STORE}} are used to read from the memory
(i.e.~copy the contents of the given memory location into accumulator
register), and write into memory (i.e.~copy the contents of the
accumulator into given memory location) respectively.

\end{tcolorbox}

\subsection{\texorpdfstring{\textcolor{red}{\underline{Register-Memory Architecture}}}{}}\label{section-2}

\begin{figure}[H]

\begin{minipage}{0.40\linewidth}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.60\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textbf{\underline{Instruction:}}\\
\textcolor{red}{\textbf{ADD}} \textbf{Rs}, \textbf{Rd}
\textbf{\emph{mem\_address}}\\
\textcolor{blue}{\textbf{ADD}} has three operands. \textcolor{red}{Rd}
and \textcolor{red}{Rs} represent the destination and source registers
respectively. The other source operand is provided through memory.

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
Two special instructions \textcolor{red}{\textbf{LOAD}} and
\textcolor{red}{\textbf{STORE}} are used to read from the memory
(i.e.~copy the contents of the given memory location into a given
register), and write into memory (i.e.~copy the contents of the
specified register into given memory location) respectively.

\end{tcolorbox}

\subsection{\texorpdfstring{\textcolor{red}{\underline{Register-Register (load/store) Architecture}}}{}}\label{section-3}

\begin{figure}[H]

\begin{minipage}{0.40\linewidth}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.60\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textbf{\underline{Instruction:}}\\
\textcolor{red}{\textbf{ADD}} \textbf{Rs, Rd, Rt}\\
\textcolor{blue}{\textbf{ADD}} has three operands. \textcolor{red}{Rd},
\textcolor{red}{Rs}, and \textcolor{red}{Rt} represent the destination
and source registers respectively.

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
Two special instructions \textcolor{red}{\textbf{LOAD}} and
\textcolor{red}{\textbf{STORE}} are used to read from the memory
(i.e.~copy the contents of the given memory location into a given
register), and write into memory (i.e.~copy the contents of the
specified register into given memory location) respectively.

\end{tcolorbox}

\begin{tcolorbox}[colback=boxbodycol2, colframe=boxheadcol2, title=Example, coltitle=boxtitlecol2, colbacktitle=boxheadcol2]
Write the instructions for the expression
\(\textcolor{red}{\textbf{C = A + B}}\) for the four classes of
instruction sets. It is assumed that A, B and C are located in memory
addresses 1000, 2000 and 3000 respectively.

\end{tcolorbox}

\begin{figure}

\begin{minipage}{0.65\linewidth}
\textcolor{red}{\textbf{(a) Stack-based architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.35\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textcolor{blue}{\textbf{PUSH 1000}}\\
\textcolor{blue}{\textbf{PUSH 2000}}\\
\textcolor{blue}{\textbf{ADD}}\\
\textcolor{blue}{\textbf{POP 3000}}

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\begin{figure}

\begin{minipage}{0.65\linewidth}
\textcolor{red}{\textbf{(b) Accumulator-based architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.35\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textcolor{blue}{\textbf{LOAD 1000}}\\
\textcolor{blue}{\textbf{ADD 2000}}\\
\textcolor{blue}{\textbf{STORE 3000}}

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\begin{figure}

\begin{minipage}{0.65\linewidth}
\textcolor{red}{\textbf{(c) Register-Memory architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.35\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textcolor{blue}{\textbf{LOAD R1, 1000}}\\
\textcolor{blue}{\textbf{ADD R2, R1, 2000}}\\
\textcolor{blue}{\textbf{STORE R2, 3000}}

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\begin{figure}

\begin{minipage}{0.65\linewidth}
\textcolor{red}{\textbf{(d) Register-Register (load/store)
architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.35\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]
\textcolor{blue}{\textbf{LOAD R1, 1000}}\\
\textcolor{blue}{\textbf{LOAD R2, 2000}}\\
\textcolor{blue}{\textbf{ADD R3, R1, R2}}\\
\textcolor{blue}{\textbf{STORE R3, 3000}}

\end{tcolorbox}

\end{minipage}%

\end{figure}%

\newpage{}

\subsection{\texorpdfstring{\textcolor{red}{\underline{Summary}:}
Different types of
ISA}{: Different types of ISA}}\label{different-types-of-isa}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\textcolor{red}{\textbf{Stack-based architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\textcolor{red}{\textbf{Accumulator-based architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
\newline
\begin{minipage}{0.50\linewidth}
\textcolor{red}{\textbf{Register-Memory architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\textcolor{red}{\textbf{Register-Register (load/store) architecture}}\\
\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%

\end{figure}%

\chapter{Instruction Set Architecture
Design}\label{instruction-set-architecture-design}

\section{\texorpdfstring{\textcolor{red}{Comparing different Instruction
Set
Architectures.}}{Comparing different Instruction Set Architectures.}}\label{comparing-different-instruction-set-architectures.}

\textcolor{red}{\textbf{Which one is the best? (for our example: C = A +
B)}}

\begin{center}
\includegraphics{lecture1-3/04-ISA-design_files/figure-pdf/isa-table-output-1.pdf}
\end{center}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, coltitle=boxtitlecol, colbacktitle=boxheadcol, title=Basic ISA Classes]
Instruction set architectures (ISA) are generally classified based on: -
the instruction word size (how many bytes for encoding each instruction)
- the number of different instructions in the ISA - the number of clock
cycles required to complete each instruction (which can be
implementation dependent)

\end{tcolorbox}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxbodycol]

Based on that, the following have been specified as different ISA
classes:

\begin{itemize}
\item
  \textcolor{red}{\textbf{RISC}} (Reduced Instruction Set Computers):
  where the size of the instruction word for all instructions are the
  same. This may lead to simpler decoding hardware. For example,
  \textbf{MIPS} (or RISC-V) processors use this type of ISA.
\item
  \textcolor{red}{\textbf{CISC}} (Complex Instruction Set Computers):
  where the size of the instruction word may be different for different
  instructions. This results in more complex decoding hardware but the
  code footprint (binary code size of the program) can be less. for
  example, \textbf{Intel X86} based processors are based on this type of
  ISA.
\item
  \textcolor{red}{\textbf{EPIC}} (Explicitly Parallel Instruction
  Computers): In this case, parallel operations are explicitly encoded
  in the instruction. The compiler plays a more important role in EPIC
  architectures. For example, \textbf{Intel Itanium} is based on this
  type of ISA.
\end{itemize}

\end{tcolorbox}

\section{\texorpdfstring{Different levels of abstraction
\textcolor{red}{(Software)}}{Different levels of abstraction (Software)}}\label{different-levels-of-abstraction-software}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol]
An abstraction removes unnecessary detail, helps us cope with the
complexity. More hardware details are considered in programming through
moving from \textcolor{red}{\textbf{High-Level Language}} to
\textcolor{red}{\textbf{Machine Language}}.

\end{tcolorbox}

\section{\texorpdfstring{\textcolor{red}{Basic steps in a CPU} for
\underline{Instruction Processing}}{Basic steps in a CPU for }}\label{basic-steps-in-a-cpu-for}

\begin{figure}

\begin{minipage}{0.30\linewidth}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.70\linewidth}
balls\end{minipage}%

\end{figure}%

\begin{figure}

\begin{minipage}{0.30\linewidth}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.70\linewidth}
balls\end{minipage}%

\end{figure}%

\begin{figure}

\begin{minipage}{0.30\linewidth}

\includegraphics{index_files/mediabag/FiKGhYhhIWJYiBgWIoaF.png}\end{minipage}%
%
\begin{minipage}{0.70\linewidth}

\begin{tcolorbox}[colback=boxbodycol, colframe=boxheadcol, colbacktitle=boxheadcol, title=\textcolor{red}{\underline{\textbf{Execution}}}]

\end{tcolorbox}

\end{minipage}%

\end{figure}%




\end{document}
